<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="http://esironal.github.io/cmtouch/lib/codemirror.css">
    <script src="http://esironal.github.io/cmtouch/lib/codemirror.js"></script>
    <script src="http://codemirror.net/mode/javascript/javascript.js"></script>
    <style>
      body {
        background: rgba(0,0,0,0.01);
        line-height: 1.5;
        font-family: "Open Sans",arial,x-locale-body,sans-serif;
        padding: 0px 6px 0px;
      }
      .sm-gist .gist-file .gist-data {
        height: 256px;
      }
    </style>
  </head>
  <body>
    <h3>Runtime type checking with <a href="https://github.com/maierfelix/Iroh">Iroh.js</a></h3>
    <div id="input"></div>
    <p><i><small>Open your console to see type warnings</small></i></p>
    <p>
      This example is about type checking and detecting polymorphic argument and return types of functions.
    </p>
    <p>
      We detect when a function's:
      <ul>
        <li> - argument type changes</li>
        <li> - argument count changes</li>
        <li> - return type changes</li>
        <li> - argument or return value is NaN</li>
      </ul>
    </p>
    <p>Code of this example</p>
    <div class="sm-gist">
      <script src="https://gist.github.com/maierfelix/9e5d73e06b31ba27c341108141eb77a2.js"></script>
    </div>
    <!-- include iroh -->
    <script type="text/javascript" src="../../dist/iroh-browser.js"></script>
    <!-- our little type check script -->
    <script type="text/javascript" src="type-check.js"></script>
    <!-- codemirror stuff -->
    <script>
    let editor = CodeMirror(document.getElementById("input"), {
      mode: "text/javascript",
      lineNumbers: true
    }).getDoc();

    editor.setValue(`function sum(a, b) {
  return a + b;
};
sum(2, 4); // sum initially called with two numbers
sum("Hello", "World!"); // sum called with two strings, warn`);

    editor.on("change", () => {
      runStage(editor.getValue());
    });
    // manually trigger change event
    editor._handlers.change[0]();

    </script>
  <body>
</html>